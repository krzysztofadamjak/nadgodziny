<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generator komend baz danych - rozszerzona wersja</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      max-width: 900px;
    }
    label {
      font-weight: bold;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      margin-bottom: 8px;
      box-sizing: border-box;
    }
    select {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      margin-bottom: 16px;
      height: 180px;
    }
    pre {
      background: #f4f4f4;
      padding: 12px;
      border-radius: 4px;
      font-size: 14px;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
    h2 {
      margin-bottom: 0;
    }
    h3 {
      margin-top: 30px;
    }
  </style>
</head>
<body>

<h2>Narzędzie do generowania komend SQL</h2>

<label for="queryInput">Co chcesz zrobić?</label>
<input type="text" id="queryInput" placeholder="Np. pobierz dane z tabeli, usuń rekord..." autocomplete="off" />

<label for="suggestions">Wybierz komendę</label>
<select id="suggestions" size="10"></select>

<h3>Wybrana komenda wraz z przykładem:</h3>
<pre id="commandOutput">Wybierz komendę z listy powyżej, aby zobaczyć przykład.</pre>

<script>
  const commands = [
    // Operacje SELECT
    {
      name: "SELECT *",
      description: "Pobierz wszystkie kolumny z tabeli",
      example: `-- Pobranie wszystkich kolumn z tabeli pracownicy\nSELECT * FROM pracownicy;`
    },
    {
      name: "SELECT z WHERE",
      description: "Pobierz dane spełniające warunek",
      example: `-- Pobranie pracowników ze stanowiskiem 'Analityk'\nSELECT * FROM pracownicy WHERE stanowisko = 'Analityk';`
    },
    {
      name: "SELECT z JOIN",
      description: "Pobierz dane łącząc tabele",
      example: `-- Pobranie pracowników i nazw działów\nSELECT p.imie, p.nazwisko, d.nazwa_dzialu FROM pracownicy p JOIN dzialy d ON p.dzial_id = d.id;`
    },
    {
      name: "SELECT DISTINCT",
      description: "Pobierz unikalne wartości",
      example: `-- Pobranie unikalnych stanowisk\nSELECT DISTINCT stanowisko FROM pracownicy;`
    },
    {
      name: "SELECT z GROUP BY",
      description: "Agreguj dane według kolumn",
      example: `-- Liczba pracowników na stanowisku\nSELECT stanowisko, COUNT(*) AS liczba FROM pracownicy GROUP BY stanowisko;`
    },
    {
      name: "SELECT z ORDER BY",
      description: "Sortuj wyniki",
      example: `-- Pracownicy posortowani alfabetycznie\nSELECT * FROM pracownicy ORDER BY nazwisko ASC;`
    },
    {
      name: "SELECT z LIMIT",
      description: "Ogranicz liczbę wyników",
      example: `-- Pobierz 10 pierwszych rekordów\nSELECT * FROM pracownicy LIMIT 10;`
    },

    // Operacje INSERT
    {
      name: "INSERT",
      description: "Dodaj nowy rekord do tabeli",
      example: `-- Dodanie nowego pracownika\nINSERT INTO pracownicy (imie, nazwisko, stanowisko) VALUES ('Anna', 'Nowak', 'Programista');`
    },
    {
      name: "INSERT z SELECT",
      description: "Dodaj rekordy na podstawie wyników zapytania",
      example: `-- Dodanie pracowników z innej tabeli\nINSERT INTO archiwum_pracownicy SELECT * FROM pracownicy WHERE data_zwolnienia IS NOT NULL;`
    },

    // Operacje UPDATE
    {
      name: "UPDATE",
      description: "Aktualizuj dane w tabeli",
      example: `-- Zmiana stanowiska pracownika o id=3\nUPDATE pracownicy SET stanowisko = 'Kierownik' WHERE id = 3;`
    },

    // Operacje DELETE
    {
      name: "DELETE",
      description: "Usuń rekordy z tabeli",
      example: `-- Usunięcie pracownika o id=10\nDELETE FROM pracownicy WHERE id = 10;`
    },

    // Operacje CREATE
    {
      name: "CREATE TABLE",
      description: "Utwórz nową tabelę",
      example: `-- Tworzenie tabeli pracownicy\nCREATE TABLE pracownicy (\n  id INT PRIMARY KEY,\n  imie VARCHAR(50),\n  nazwisko VARCHAR(50),\n  stanowisko VARCHAR(50),\n  data_zatrudnienia DATE\n);`
    },
    {
      name: "CREATE INDEX",
      description: "Utwórz indeks dla przyspieszenia wyszukiwania",
      example: `-- Indeks na kolumnę nazwisko\nCREATE INDEX idx_nazwisko ON pracownicy (nazwisko);`
    },
    {
      name: "CREATE VIEW",
      description: "Utwórz widok (zapytanie zapisane jako tabela)",
      example: `-- Widok aktywnych pracowników\nCREATE VIEW aktywni_pracownicy AS SELECT * FROM pracownicy WHERE status = 'aktywny';`
    },

    // Operacje ALTER
    {
      name: "ALTER TABLE - dodaj kolumnę",
      description: "Dodaj nową kolumnę do tabeli",
      example: `-- Dodanie kolumny email do pracowników\nALTER TABLE pracownicy ADD email VARCHAR(100);`
    },
    {
      name: "ALTER TABLE - zmień typ kolumny",
      description: "Zmień typ danych kolumny",
      example: `-- Zmiana typu kolumny data_zatrudnienia\nALTER TABLE pracownicy ALTER COLUMN data_zatrudnienia TYPE TIMESTAMP;`
    },
    {
      name: "ALTER TABLE - usuń kolumnę",
      description: "Usuń kolumnę z tabeli",
      example: `-- Usunięcie kolumny email\nALTER TABLE pracownicy DROP COLUMN email;`
    },

    // Operacje DROP
    {
      name: "DROP TABLE",
      description: "Usuń tabelę z bazy",
      example: `-- Usunięcie tabeli archiwum_pracownicy\nDROP TABLE archiwum_pracownicy;`
    },
    {
      name: "DROP INDEX",
      description: "Usuń indeks",
      example: `-- Usunięcie indeksu idx_nazwisko\nDROP INDEX idx_nazwisko;`
    },
    {
      name: "DROP VIEW",
      description: "Usuń widok",
      example: `-- Usunięcie widoku aktywni_pracownicy\nDROP VIEW aktywni_pracownicy;`
    },

    // Transakcje i kontrola
    {
      name: "BEGIN TRANSACTION",
      description: "Rozpocznij transakcję",
      example: `-- Rozpoczęcie transakcji\nBEGIN TRANSACTION;`
    },
    {
      name: "COMMIT",
      description: "Zatwierdź transakcję",
      example: `-- Zatwierdzenie zmian\nCOMMIT;`
    },
    {
      name: "ROLLBACK",
      description: "Cofnij transakcję",
      example: `-- Wycofanie zmian\nROLLBACK;`
    },

    // Uprawnienia
    {
      name: "GRANT",
      description: "Nadaj uprawnienia użytkownikowi",
      example: `-- Nadanie prawa SELECT na tabelę pracownicy\nGRANT SELECT ON pracownicy TO 'janek';`
    },
    {
      name: "REVOKE",
      description: "Cofnij uprawnienia",
      example: `-- Cofnięcie prawa SELECT\nREVOKE SELECT ON pracownicy FROM 'janek';`
    },

    // Backup i przywracanie (przykładowe komendy specyficzne)
    {
      name: "BACKUP DATABASE",
      description: "Backup bazy danych (syntax może się różnić w zależności od silnika)",
      example: `-- Backup bazy danych\nBACKUP DATABASE moja_baza TO DISK = 'C:\\backup\\moja_baza.bak';`
    },
    {
      name: "RESTORE DATABASE",
      description: "Przywracanie bazy danych",
      example: `-- Przywrócenie bazy danych\nRESTORE DATABASE moja_baza FROM DISK = 'C:\\backup\\moja_baza.bak';`
    },

    // Optymalizacja i analiza
    {
      name: "EXPLAIN",
      description: "Analiza planu zapytania",
      example: `-- Plan wykonania zapytania\nEXPLAIN SELECT * FROM pracownicy WHERE stanowisko = 'Analityk';`
    },
    {
      name: "ANALYZE",
      description: "Zbierz statystyki optymalizatora",
      example: `-- Analiza tabeli pracownicy\nANALYZE pracownicy;`
    },

    // Specjalne operacje SQL
    {
      name: "TRUNCATE TABLE",
      description: "Usuń wszystkie rekordy z tabeli szybciej niż DELETE",
      example: `-- Szybkie usunięcie wszystkich danych\nTRUNCATE TABLE pracownicy;`
    },
    {
      name: "CREATE PROCEDURE",
      description: "Utwórz procedurę składowaną",
      example: `-- Procedura dodająca pracownika\nCREATE PROCEDURE dodaj_pracownika (IN imie VARCHAR(50), IN nazwisko VARCHAR(50))\nBEGIN\n  INSERT INTO pracownicy (imie, nazwisko) VALUES (imie, nazwisko);\nEND;`
    },
    {
      name: "EXECUTE PROCEDURE",
      description: "Wywołaj procedurę składowaną",
      example: `-- Wywołanie procedury\nCALL dodaj_pracownika('Maria', 'Kowalczyk');`
    },
  ];

  const input = document.getElementById('queryInput');
  const suggestions = document.getElementById('suggestions');
  const output = document.getElementById('commandOutput');

  function updateSuggestions() {
    const text = input.value.toLowerCase().trim();
    suggestions.innerHTML = '';

    if(text.length === 0) {
      output.textContent = 'Wybierz komendę z listy powyżej, aby zobaczyć przykład.';
      return;
    }

    const filtered = commands.filter(cmd =>
      cmd.name.toLowerCase().includes(text) ||
      cmd.description.toLowerCase().includes(text)
    );

    if(filtered.length === 0) {
      suggestions.innerHTML = '<option disabled>Brak dopasowań</option>';
      output.textContent = 'Brak komendy pasującej do wpisanego zapytania.';
      return;
    }

    filtered.forEach((cmd, i) => {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = `${cmd.name} - ${cmd.description}`;
      suggestions.appendChild(option);
    });

    suggestions.selectedIndex = 0;
    showExample(filtered[0]);
  }

  function showExample(cmd) {
    output.textContent = cmd.example;
  }

  suggestions.addEventListener('change', () => {
    const idx = suggestions.selectedIndex;
    if(idx < 0) return;

    const text = input.value.toLowerCase().trim();
    const filtered = commands.filter(cmd =>
      cmd.name.toLowerCase().includes(text) ||
      cmd.description.toLowerCase().includes(text)
    );

    if(filtered.length > 0) {
      showExample(filtered[idx]);
    }
  });

  input.addEventListener('input', updateSuggestions);

  updateSuggestions();
</script>

</body>
</html>
